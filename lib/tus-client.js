!function e(t,i,n){function r(s,u){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!u&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=i[s]={exports:{}};t[s][0].call(h.exports,function(e){var i=t[s][1][e];return r(i?i:e)},h,h.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t){(function(){var i,n;i=e("jquery"),n=function(){function e(t,n){this.file=t,this.options=i.extend(e.DEFAULTS,n),this.fileUrl=null,this._jqXHR=null,this._deferred=i.Deferred(),this._deferred.promise(this)}return e.DEFAULTS={path:"",headers:{}},e.prototype._checkFileExists=function(){var e,t;return e=i.extend({"file-path":""+this.options.path+"/"+this.file.name},this.options.headers),t={type:"HEAD",url:this.options.endpoint,cache:!1,headers:e},i.ajax(t).fail(function(e){return function(t,i){return 404===t.status?e._emitFail("File not found: "+i,t.status):e._emitFail(i,t.status)}}(this)).done(function(e){return function(){return e._emitDone()}}(this))},e.prototype.stop=function(){return null!=this._jqXHR?this._jqXHR.abort():void 0},e.prototype._emitDone=function(){return this._deferred.resolveWith(this,[this.fileUrl,this.file])},e.prototype._emitFail=function(e,t){return this._deferred.rejectWith(this,[e,t])},e}(),t.exports=n}).call(this)},{jquery:"eeO1y8"}],2:[function(e,t){(function(){var i,n,r;("undefined"==typeof jQuery||null===jQuery)&&(i=e("jquery")),("undefined"==typeof r||null===r)&&(r=e("spark-md5")),n=function(){function e(t,n){this.file=t,this.options=i.extend(e.DEFAULTS,n),(null===this.options.chunkSize||this.options.chunkSize<2097152)&&(this.options.chunkSize=2097152),this.spark=new r,this.fileReader=new FileReader,this.fileReader.onload=function(e){return function(t){return e.spark.appendBinary(t.target.result),e._emitProgress(),e._computeChecksum(e.range_to)}}(this),this.fileReader.onerror=function(e){return function(t){return e._emitFail(t)}}(this),this._deferred=i.Deferred(),this._deferred.promise(this)}return e.DEFAULTS={chunkSize:2097152},e.prototype._computeChecksum=function(e){var t,i,n,r;return this.bytesWritten=e,this.bytesWritten===this.file.size?(this.clientChecksum=this.spark.end(),void this._emitDone()):(n=this.file.size,i=this.options.chunkSize,this.range_to=Math.min(n,e+i),r=this.file.slice||this.file.webkitSlice||this.file.mozSlice,t=r.call(this.file,e,this.range_to,this.file.type),this.fileReader.readAsBinaryString(t))},e.prototype.stop=function(){return this.bytesWritten=this.file.size,this.spark.end(),this._emitFail("FileChecksum stopped!")},e.prototype._emitProgress=function(e){return null==e&&(e=null),this._deferred.notifyWith(this,[e,this.bytesWritten,this.file.size])},e.prototype._emitDone=function(){return this._deferred.resolveWith(this,[this.file,this.clientChecksum])},e.prototype._emitFail=function(e){return this._deferred.rejectWith(this,[e])},e}(),t.exports=n}).call(this)},{jquery:"eeO1y8","spark-md5":"aLLAwy"}],3:[function(e,t){(function(){var i,n,r,o={}.hasOwnProperty,s=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};("undefined"==typeof jQuery||null===jQuery)&&(i=e("jquery")),r=e("./ResumableUpload"),n=function(e){function t(e,n){n=i.extend(t.DEFAULTS,n),this._chunkTimer=-1,t.__super__.constructor.call(this,e,n)}return s(t,e),t.DEFAULTS={chunkSize:1,minChunkSize:51200,maxChunkSize:2097152,path:""},t.prototype._getChunkSize=function(){var e,t;return this._chunkTimer<0?e=this.options.minChunkSize:(t=(new Date).getTime()-this._chunkTimer,e=Math.round(this.options.chunkSize/t*1e3)),this._chunkTimer=(new Date).getTime(),Math.min(Math.max(this.options.minChunkSize,e),this.options.maxChunkSize)},t.prototype._uploadFile=function(e){return this.options.chunkSize&&(this.options.chunkSize=this._getChunkSize()),t.__super__._uploadFile.call(this,e)},t.prototype._emitDone=function(){return this._moveFile()},t.prototype._moveDone=function(e){return this._deferred.resolveWith(this,[this.fileUrl,this.file,e])},t.prototype._moveFile=function(){var e,t;return e=i.extend({"Final-Length":this.file.size,"file-path":""+this.options.path+"/"+this.file.name},this.options.headers),t={type:"PUT",url:this.fileUrl,cache:!1,headers:e},i.ajax(t).fail(function(e){return function(t,i){return 404===t.status?e._emitFail("Could not move file resource: "+i,t.status):e._emitFail("Could not head at file resource: "+i,t.status)}}(this)).done(function(e){return function(t,i,n){var r,o;return r=n.getResponseHeader("Checksum"),(o=n.getResponseHeader("Location"))?(e.fileUrl=o,e._moveDone(r)):e._emitFail("Could not get url for file resource. "+i,n.status)}}(this))},t}(r),t.exports=n}).call(this)},{"./ResumableUpload":4,jquery:"eeO1y8"}],4:[function(e,t){(function(){var i,n;("undefined"==typeof jQuery||null===jQuery)&&(i=e("jquery")),n=function(){function e(t,n){this.file=t,this.options=i.extend(e.DEFAULTS,n),this.fileUrl=null,this.bytesWritten=null,this._jqXHR=null,this._deferred=i.Deferred(),this._deferred.promise(this)}return e.SUPPORT=function(){return!("undefined"==typeof File||"undefined"==typeof Blob||"undefined"==typeof FileList||!Blob.prototype.webkitSlice&&!Blob.prototype.mozSlice&&!Blob.prototype.slice)},e.DEFAULTS={resumable:!0,headers:{}},e.prototype._start=function(){return this.options.resumable&&this.options.resetBefore!==!0||this._urlCache(!1),(this.fileUrl=this._urlCache())?this._head():this._post()},e.prototype._post=function(){var e,t;return e=i.extend({"Final-Length":this.file.size},this.options.headers),t={type:"POST",url:this.options.endpoint,headers:e},i.ajax(t).fail(function(e){return function(t,i){return e._emitFail("Could not post to file resource "+e.options.endpoint+". "+i,t.status)}}(this)).done(function(e){return function(t,i,n){var r;return(r=n.getResponseHeader("Location"))?(e.fileUrl=r,e._uploadFile(0)):_emitFail("Could not get url for file resource. "+i,n.status)}}(this))},e.prototype._head=function(){var e;return e={type:"HEAD",url:this.fileUrl,cache:!1,headers:this.options.headers},i.ajax(e).fail(function(e){return function(t,i){return 404===t.status?e._post():e._emitFail("Could not head at file resource: "+i,t.status)}}(this)).done(function(e){return function(t,i,n){var r,o;return o=n.getResponseHeader("Offset"),r=parseInt(o,10)?parseInt(o):0,e._uploadFile(r)}}(this))},e.prototype._uploadFile=function(e){var t,n,r,o,s,u,l;return this.bytesWritten=e,this.bytesWritten===this.file.size?(this._emitProgress(),this._emitDone()):(this._urlCache(this.fileUrl),this._emitProgress(),n=this.bytesWritten,s=this.file.size,this.options.chunkSize&&(s=Math.min(s,e+this.options.chunkSize)),u=this.file.slice||this.file.webkitSlice||this.file.mozSlice,t=u.call(this.file,e,s,this.file.type),l=i.ajaxSettings.xhr(),r=i.extend({Offset:e,"Content-Type":"application/offset+octet-stream"},this.options.headers),o={type:"PATCH",url:this.fileUrl,data:t,processData:!1,contentType:this.file.type,cache:!1,headers:r,xhr:function(){return l}},i(l.upload).bind("progress",function(e){return function(t){return e.bytesWritten=n+t.originalEvent.loaded,e._emitProgress(t)}}(this)),this._jqXHR=i.ajax(o).fail(function(e){return function(t,i,n){var r;return r=t.responseText||i||n,e._emitFail(r,t.status)}}(this)).done(function(e){return function(){return s===e.file.size?(e.options.resetAfter&&e._urlCache(!1),e._emitDone()):e._uploadFile(s)}}(this)))},e.prototype.stop=function(){return null!=this._jqXHR?this._jqXHR.abort():void 0},e.prototype._emitProgress=function(e){return null==e&&(e=null),this._deferred.notifyWith(this,[e,this.bytesWritten,this.file.size])},e.prototype._emitDone=function(){return this._deferred.resolveWith(this,[this.fileUrl,this.file])},e.prototype._emitFail=function(e,t){return this._deferred.rejectWith(this,[e,t])},e.prototype._urlCache=function(e){var t,i,n;if(i=this.options.fingerprint,null==i&&(i=this.fingerprint(this.file)),e===!1)return localStorage.removeItem(i);if(e){n=!1;try{n=localStorage.setItem(i,e)}catch(r){t=r}return n}return localStorage.getItem(i)},e.prototype.fingerprint=function(e){return"tus-"+e.name+"-"+e.type+"-"+e.size},e}(),t.exports=n}).call(this)},{jquery:"eeO1y8"}],5:[function(e,t){(function(i){var n,r,o,s,u,l;("undefined"==typeof jQuery||null===jQuery)&&(n=e("jquery")),("undefined"==typeof u||null===u)&&(u=e("q")),l=e("./ResumableUpload"),s=e("./PolyResumableUpload"),r=e("./CheckFileExists"),o=e("./FileChecksum"),i.gr=i.gr||{},i.gr.polyptychon=i.gr.polyptychon||{},i.gr.polyptychon.tus={upload:function(e,t){var i,n;return i=u.defer(),n=new s(e,t),e.action=n,n.fail(function(t,n){return e.action=null,i.reject(new Error({error:t,status:n}))}),n.progress(function(e,t,r){var o;return o=(t/r*100).toFixed(2),i.notify({action:n,percentage:o})}),n.done(function(e,t,n){return t.action=null,t.md5?t.md5===n?i.resolve({url:e,file:t,md5:n}):i.reject(new Error("Checksum does not match. "+t.md5+" != "+n)):(t.md5=n,i.resolve({url:e,file:t,md5:n}))}),e&&n._start(),i.promise},check:function(e,t){var i,n;return n=u.defer(),i=new r(e,t),e&&i._checkFileExists(),i.fail(function(){return n.resolve(e)}).done(function(e,t){return n.reject({message:"File already exist",file:t})}),n.promise},checksum:function(e,t){var i,n;return n=u.defer(),i=new o(e,t),e.action=i,i.fail(function(t){return e.action=null,n.reject(new Error(t))}),i.progress(function(e,t,r){var o;return o=(t/r*100).toFixed(2),n.notify({action:i,percentage:o})}),i.done(function(e,t){return e.action=null,e.md5=t,n.resolve({file:e,md5:t})}),e&&i._computeChecksum(0),n.promise},stop:function(e){return e.action?e.action.stop():void 0},checkAll:function(e,t){var i,n,r,o;for(n=[],r=0,o=e.length;o>r;r++)i=e[r],n.push(this.check(i,t));return u.all(n)},checksumAll:function(e,t){var i,n,r,o;for(n=[],r=0,o=e.length;o>r;r++)i=e[r],n.push(this.checksum(i,t));return u.all(n)},uploadAll:function(e,t){var i,n,r,o;for(n=[],r=0,o=e.length;o>r;r++)i=e[r],n.push(this.upload(i,t));return u.all(n)},stopAll:function(e){var t,i,n,r;for(r=[],i=0,n=e.length;n>i;i++)t=e[i],r.push(this.stop(t));return r},UploadSupport:l.SUPPORT},t.exports=i.gr.polyptychon.tus}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./CheckFileExists":1,"./FileChecksum":2,"./PolyResumableUpload":3,"./ResumableUpload":4,jquery:"eeO1y8",q:"GOrh4h"}]},{},[5]);