!function t(e,r,n){function i(s,u){if(!r[s]){if(!e[s]){var h="function"==typeof require&&require;if(!u&&h)return h(s,!0);if(o)return o(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){var r=e[s][1][t];return i(r?r:t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e){(function(r){var n,i,o,s,u,h;("undefined"==typeof jQuery||null===jQuery)&&(n=t("jquery")),null==n&&(n=jQuery),null==r.Q&&(u=t("q")),null!=r.Q&&(u=r.Q),h=t("./ResumableUpload"),s=t("./PolyResumableUpload"),i=t("./CheckFileExists"),o=t("./FileChecksum"),r.gr=r.gr||{},r.gr.polyptychon=r.gr.polyptychon||{},r.gr.polyptychon.tus={upload:function(t,e){var r,n;return r=u.defer(),n=new s(t,e),t.action=n,n.fail(function(e,n){return t.action=null,r.reject(new Error({error:e,status:n}))}),n.progress(function(t,e,i){var o;return o=(e/i*100).toFixed(2),r.notify({action:n,percentage:o})}),n.done(function(t,e,n){return e.action=null,e.md5?e.md5===n?r.resolve({url:t,file:e,md5:n}):r.reject(new Error("Checksum does not match. "+e.md5+" != "+n)):(e.md5=n,r.resolve({url:t,file:e,md5:n}))}),t&&n._start(),r.promise},check:function(t,e){var r,n;return n=u.defer(),r=new i(t,e),t&&r._checkFileExists(),r.fail(function(){return n.resolve(t)}).done(function(t,e){return n.reject({message:"File already exist",file:e})}),n.promise},checksum:function(t,e){var r,n;return n=u.defer(),r=new o(t,e),t.action=r,r.fail(function(e){return t.action=null,n.reject(new Error(e))}),r.progress(function(t,e,i){var o;return o=(e/i*100).toFixed(2),n.notify({action:r,percentage:o})}),r.done(function(t,e){return t.action=null,t.md5=e,n.resolve({file:t,md5:e})}),t&&r._computeChecksum(0),n.promise},stop:function(t){return t.action?t.action.stop():void 0},checkAll:function(t,e){var r,n,i,o;for(n=[],i=0,o=t.length;o>i;i++)r=t[i],n.push(this.check(r,e));return u.all(n)},checksumAll:function(t,e){var r,n,i,o;for(n=[],i=0,o=t.length;o>i;i++)r=t[i],n.push(this.checksum(r,e));return u.all(n)},uploadAll:function(t,e){var r,n,i,o;for(n=[],i=0,o=t.length;o>i;i++)r=t[i],n.push(this.upload(r,e));return u.all(n)},stopAll:function(t){var e,r,n,i;for(i=[],r=0,n=t.length;n>r;r++)e=t[r],i.push(this.stop(e));return i},UploadSupport:h.SUPPORT},e.exports=r.gr.polyptychon.tus}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./CheckFileExists":2,"./FileChecksum":3,"./PolyResumableUpload":4,"./ResumableUpload":5,jquery:"jquery",q:"q"}],2:[function(t,e){(function(){var r,n;("undefined"==typeof jQuery||null===jQuery)&&(r=t("jquery")),null==r&&(r=jQuery),n=function(){function t(e,n){this.file=e,this.options=r.extend(t.DEFAULTS,n),this.fileUrl=null,this._jqXHR=null,this._deferred=r.Deferred(),this._deferred.promise(this)}return t.DEFAULTS={path:"",headers:{}},t.prototype._checkFileExists=function(){var t,e;return t=r.extend({"file-path":""+this.options.path+"/"+this.file.name},this.options.headers),e={type:"HEAD",url:this.options.endpoint,cache:!1,headers:t},r.ajax(e).fail(function(t){return function(e,r){return 404===e.status?t._emitFail("File not found: "+r,e.status):t._emitFail(r,e.status)}}(this)).done(function(t){return function(){return t._emitDone()}}(this))},t.prototype.stop=function(){return null!=this._jqXHR?this._jqXHR.abort():void 0},t.prototype._emitDone=function(){return this._deferred.resolveWith(this,[this.fileUrl,this.file])},t.prototype._emitFail=function(t,e){return this._deferred.rejectWith(this,[t,e])},t}(),e.exports=n}).call(this)},{jquery:"jquery"}],3:[function(t,e){(function(){var r,n,i;("undefined"==typeof jQuery||null===jQuery)&&(r=t("jquery")),null==r&&(r=jQuery),("undefined"==typeof i||null===i)&&(i=t("spark-md5")),n=function(){function t(e,n){this.file=e,this.options=r.extend(t.DEFAULTS,n),(null===this.options.chunkSize||this.options.chunkSize<2097152)&&(this.options.chunkSize=2097152),this.spark=new i,this.fileReader=new FileReader,this.fileReader.onload=function(t){return function(e){return t.spark.appendBinary(e.target.result),t._emitProgress(),t._computeChecksum(t.range_to)}}(this),this.fileReader.onerror=function(t){return function(e){return t._emitFail(e)}}(this),this._deferred=r.Deferred(),this._deferred.promise(this)}return t.DEFAULTS={chunkSize:2097152},t.prototype._computeChecksum=function(t){var e,r,n,i;return this.bytesWritten=t,this.bytesWritten===this.file.size?(this.clientChecksum=this.spark.end(),this._emitDone(),void 0):(n=this.file.size,r=this.options.chunkSize,this.range_to=Math.min(n,t+r),i=this.file.slice||this.file.webkitSlice||this.file.mozSlice,e=i.call(this.file,t,this.range_to,this.file.type),this.fileReader.readAsBinaryString(e))},t.prototype.stop=function(){return this.bytesWritten=this.file.size,this.spark.end(),this._emitFail("FileChecksum stopped!")},t.prototype._emitProgress=function(t){return null==t&&(t=null),this._deferred.notifyWith(this,[t,this.bytesWritten,this.file.size])},t.prototype._emitDone=function(){return this._deferred.resolveWith(this,[this.file,this.clientChecksum])},t.prototype._emitFail=function(t){return this._deferred.rejectWith(this,[t])},t}(),e.exports=n}).call(this)},{jquery:"jquery","spark-md5":6}],4:[function(t,e){(function(){var r,n,i,o={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};("undefined"==typeof jQuery||null===jQuery)&&(r=t("jquery")),null==r&&(r=jQuery),i=t("./ResumableUpload"),n=function(t){function e(t,n){n=r.extend(e.DEFAULTS,n),this._chunkTimer=-1,e.__super__.constructor.call(this,t,n)}return s(e,t),e.DEFAULTS={chunkSize:1,minChunkSize:51200,maxChunkSize:2097152,path:""},e.prototype._getChunkSize=function(){var t,e;return this._chunkTimer<0?t=this.options.minChunkSize:(e=(new Date).getTime()-this._chunkTimer,t=Math.round(this.options.chunkSize/e*1e3)),this._chunkTimer=(new Date).getTime(),Math.min(Math.max(this.options.minChunkSize,t),this.options.maxChunkSize)},e.prototype._uploadFile=function(t){return this.options.chunkSize&&(this.options.chunkSize=this._getChunkSize()),e.__super__._uploadFile.call(this,t)},e.prototype._emitDone=function(){return this._moveFile()},e.prototype._moveDone=function(t){return this._deferred.resolveWith(this,[this.fileUrl,this.file,t])},e.prototype._moveFile=function(){var t,e;return t=r.extend({"Final-Length":this.file.size,"file-path":""+this.options.path+"/"+this.file.name},this.options.headers),e={type:"PUT",url:this.fileUrl,cache:!1,headers:t},r.ajax(e).fail(function(t){return function(e,r){return 404===e.status?t._emitFail("Could not move file resource: "+r,e.status):t._emitFail("Could not head at file resource: "+r,e.status)}}(this)).done(function(t){return function(e,r,n){var i,o;return i=n.getResponseHeader("Checksum"),(o=n.getResponseHeader("Location"))?(t.fileUrl=o,t._moveDone(i)):t._emitFail("Could not get url for file resource. "+r,n.status)}}(this))},e}(i),e.exports=n}).call(this)},{"./ResumableUpload":5,jquery:"jquery"}],5:[function(t,e){(function(){var r,n;("undefined"==typeof jQuery||null===jQuery)&&(r=t("jquery")),null==r&&(r=jQuery),n=function(){function t(e,n){this.file=e,this.options=r.extend(t.DEFAULTS,n),this.fileUrl=null,this.bytesWritten=null,this._jqXHR=null,this._deferred=r.Deferred(),this._deferred.promise(this)}return t.SUPPORT=function(){return!("undefined"==typeof File||"undefined"==typeof Blob||"undefined"==typeof FileList||!Blob.prototype.webkitSlice&&!Blob.prototype.mozSlice&&!Blob.prototype.slice)},t.DEFAULTS={resumable:!0,headers:{}},t.prototype._start=function(){return this.options.resumable&&this.options.resetBefore!==!0||this._urlCache(!1),(this.fileUrl=this._urlCache())?this._head():this._post()},t.prototype._post=function(){var t,e;return t=r.extend({"Final-Length":this.file.size},this.options.headers),e={type:"POST",url:this.options.endpoint,headers:t},r.ajax(e).fail(function(t){return function(e,r){return t._emitFail("Could not post to file resource "+t.options.endpoint+". "+r,e.status)}}(this)).done(function(t){return function(e,r,n){var i;return(i=n.getResponseHeader("Location"))?(t.fileUrl=i,t._uploadFile(0)):_emitFail("Could not get url for file resource. "+r,n.status)}}(this))},t.prototype._head=function(){var t;return t={type:"HEAD",url:this.fileUrl,cache:!1,headers:this.options.headers},r.ajax(t).fail(function(t){return function(e,r){return 404===e.status?t._post():t._emitFail("Could not head at file resource: "+r,e.status)}}(this)).done(function(t){return function(e,r,n){var i,o;return o=n.getResponseHeader("Offset"),i=parseInt(o,10)?parseInt(o):0,t._uploadFile(i)}}(this))},t.prototype._uploadFile=function(t){var e,n,i,o,s,u,h;return this.bytesWritten=t,this.bytesWritten===this.file.size?(this._emitProgress(),this._emitDone()):(this._urlCache(this.fileUrl),this._emitProgress(),n=this.bytesWritten,s=this.file.size,this.options.chunkSize&&(s=Math.min(s,t+this.options.chunkSize)),u=this.file.slice||this.file.webkitSlice||this.file.mozSlice,e=u.call(this.file,t,s,this.file.type),h=r.ajaxSettings.xhr(),i=r.extend({Offset:t,"Content-Type":"application/offset+octet-stream"},this.options.headers),o={type:"PATCH",url:this.fileUrl,data:e,processData:!1,contentType:this.file.type,cache:!1,headers:i,xhr:function(){return h}},r(h.upload).bind("progress",function(t){return function(e){return t.bytesWritten=n+e.originalEvent.loaded,t._emitProgress(e)}}(this)),this._jqXHR=r.ajax(o).fail(function(t){return function(e,r,n){var i;return i=e.responseText||r||n,t._emitFail(i,e.status)}}(this)).done(function(t){return function(){return s===t.file.size?(t.options.resetAfter&&t._urlCache(!1),t._emitDone()):t._uploadFile(s)}}(this)))},t.prototype.stop=function(){return null!=this._jqXHR?this._jqXHR.abort():void 0},t.prototype._emitProgress=function(t){return null==t&&(t=null),this._deferred.notifyWith(this,[t,this.bytesWritten,this.file.size])},t.prototype._emitDone=function(){return this._deferred.resolveWith(this,[this.fileUrl,this.file])},t.prototype._emitFail=function(t,e){return this._deferred.rejectWith(this,[t,e])},t.prototype._urlCache=function(t){var e,r,n;if(r=this.options.fingerprint,null==r&&(r=this.fingerprint(this.file)),t===!1)return localStorage.removeItem(r);if(t){n=!1;try{n=localStorage.setItem(r,t)}catch(i){e=i}return n}return localStorage.getItem(r)},t.prototype.fingerprint=function(t){return"tus-"+t.name+"-"+t.type+"-"+t.size},t}(),e.exports=n}).call(this)},{jquery:"jquery"}],6:[function(t,e,r){!function(t){if("object"==typeof r)e.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var n;try{n=window}catch(i){n=self}n.SparkMD5=t()}}(function(){"use strict";var t=function(t,e){return t+e&4294967295},e=function(e,r,n,i,o,s){return r=t(t(r,e),t(i,s)),t(r<<o|r>>>32-o,n)},r=function(t,r,n,i,o,s,u){return e(r&n|~r&i,t,r,o,s,u)},n=function(t,r,n,i,o,s,u){return e(r&i|n&~i,t,r,o,s,u)},i=function(t,r,n,i,o,s,u){return e(r^n^i,t,r,o,s,u)},o=function(t,r,n,i,o,s,u){return e(n^(r|~i),t,r,o,s,u)},s=function(e,s){var u=e[0],h=e[1],f=e[2],l=e[3];u=r(u,h,f,l,s[0],7,-680876936),l=r(l,u,h,f,s[1],12,-389564586),f=r(f,l,u,h,s[2],17,606105819),h=r(h,f,l,u,s[3],22,-1044525330),u=r(u,h,f,l,s[4],7,-176418897),l=r(l,u,h,f,s[5],12,1200080426),f=r(f,l,u,h,s[6],17,-1473231341),h=r(h,f,l,u,s[7],22,-45705983),u=r(u,h,f,l,s[8],7,1770035416),l=r(l,u,h,f,s[9],12,-1958414417),f=r(f,l,u,h,s[10],17,-42063),h=r(h,f,l,u,s[11],22,-1990404162),u=r(u,h,f,l,s[12],7,1804603682),l=r(l,u,h,f,s[13],12,-40341101),f=r(f,l,u,h,s[14],17,-1502002290),h=r(h,f,l,u,s[15],22,1236535329),u=n(u,h,f,l,s[1],5,-165796510),l=n(l,u,h,f,s[6],9,-1069501632),f=n(f,l,u,h,s[11],14,643717713),h=n(h,f,l,u,s[0],20,-373897302),u=n(u,h,f,l,s[5],5,-701558691),l=n(l,u,h,f,s[10],9,38016083),f=n(f,l,u,h,s[15],14,-660478335),h=n(h,f,l,u,s[4],20,-405537848),u=n(u,h,f,l,s[9],5,568446438),l=n(l,u,h,f,s[14],9,-1019803690),f=n(f,l,u,h,s[3],14,-187363961),h=n(h,f,l,u,s[8],20,1163531501),u=n(u,h,f,l,s[13],5,-1444681467),l=n(l,u,h,f,s[2],9,-51403784),f=n(f,l,u,h,s[7],14,1735328473),h=n(h,f,l,u,s[12],20,-1926607734),u=i(u,h,f,l,s[5],4,-378558),l=i(l,u,h,f,s[8],11,-2022574463),f=i(f,l,u,h,s[11],16,1839030562),h=i(h,f,l,u,s[14],23,-35309556),u=i(u,h,f,l,s[1],4,-1530992060),l=i(l,u,h,f,s[4],11,1272893353),f=i(f,l,u,h,s[7],16,-155497632),h=i(h,f,l,u,s[10],23,-1094730640),u=i(u,h,f,l,s[13],4,681279174),l=i(l,u,h,f,s[0],11,-358537222),f=i(f,l,u,h,s[3],16,-722521979),h=i(h,f,l,u,s[6],23,76029189),u=i(u,h,f,l,s[9],4,-640364487),l=i(l,u,h,f,s[12],11,-421815835),f=i(f,l,u,h,s[15],16,530742520),h=i(h,f,l,u,s[2],23,-995338651),u=o(u,h,f,l,s[0],6,-198630844),l=o(l,u,h,f,s[7],10,1126891415),f=o(f,l,u,h,s[14],15,-1416354905),h=o(h,f,l,u,s[5],21,-57434055),u=o(u,h,f,l,s[12],6,1700485571),l=o(l,u,h,f,s[3],10,-1894986606),f=o(f,l,u,h,s[10],15,-1051523),h=o(h,f,l,u,s[1],21,-2054922799),u=o(u,h,f,l,s[8],6,1873313359),l=o(l,u,h,f,s[15],10,-30611744),f=o(f,l,u,h,s[6],15,-1560198380),h=o(h,f,l,u,s[13],21,1309151649),u=o(u,h,f,l,s[4],6,-145523070),l=o(l,u,h,f,s[11],10,-1120210379),f=o(f,l,u,h,s[2],15,718787259),h=o(h,f,l,u,s[9],21,-343485551),e[0]=t(u,e[0]),e[1]=t(h,e[1]),e[2]=t(f,e[2]),e[3]=t(l,e[3])},u=function(t){var e,r=[];for(e=0;64>e;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r},h=function(t){var e,r=[];for(e=0;64>e;e+=4)r[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return r},f=function(t){var e,r,n,i,o,h,f=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;f>=e;e+=64)s(l,u(t.substring(e-64,e)));for(t=t.substring(e-64),r=t.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;r>e;e+=1)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(s(l,n),e=0;16>e;e+=1)n[e]=0;return i=8*f,i=i.toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(i[2],16),h=parseInt(i[1],16)||0,n[14]=o,n[15]=h,s(l,n),l},l=function(t){var e,r,n,i,o,u,f=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;f>=e;e+=64)s(l,h(t.subarray(e-64,e)));for(t=f>e-64?t.subarray(e-64):new Uint8Array(0),r=t.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;r>e;e+=1)n[e>>2]|=t[e]<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(s(l,n),e=0;16>e;e+=1)n[e]=0;return i=8*f,i=i.toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(i[2],16),u=parseInt(i[1],16)||0,n[14]=o,n[15]=u,s(l,n),l},a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],c=function(t){var e,r="";for(e=0;4>e;e+=1)r+=a[t>>8*e+4&15]+a[t>>8*e&15];return r},p=function(t){var e;for(e=0;e<t.length;e+=1)t[e]=c(t[e]);return t.join("")},d=function(t){return p(f(t))},y=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==d("hello")&&(t=function(t,e){var r=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(r>>16);return n<<16|65535&r}),y.prototype.append=function(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),this.appendBinary(t),this},y.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,r=this._buff.length;for(e=64;r>=e;e+=64)s(this._state,u(this._buff.substring(e-64,e)));return this._buff=this._buff.substr(e-64),this},y.prototype.end=function(t){var e,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;i>e;e+=1)o[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(o,i),r=t?this._state:p(this._state),this.reset(),r},y.prototype._finish=function(t,e){var r,n,i,o=e;if(t[o>>2]|=128<<(o%4<<3),o>55)for(s(this._state,t),o=0;16>o;o+=1)t[o]=0;r=8*this._length,r=r.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(r[2],16),i=parseInt(r[1],16)||0,t[14]=n,t[15]=i,s(this._state,t)},y.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},y.hash=function(t,e){/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t)));var r=f(t);return e?r:p(r)},y.hashBinary=function(t,e){var r=f(t);return e?r:p(r)},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(t){var e,r=this._concatArrayBuffer(this._buff,t),n=r.length;for(this._length+=t.byteLength,e=64;n>=e;e+=64)s(this._state,h(r.subarray(e-64,e)));return this._buff=n>e-64?r.subarray(e-64):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(t){var e,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;i>e;e+=1)o[e>>2]|=n[e]<<(e%4<<3);return this._finish(o,i),r=t?this._state:p(this._state),this.reset(),r},y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._concatArrayBuffer=function(t,e){var r=t.length,n=new Uint8Array(r+e.byteLength);return n.set(t),n.set(new Uint8Array(e),r),n},y.ArrayBuffer.hash=function(t,e){var r=l(new Uint8Array(t));return e?r:p(r)},y})},{}]},{},[1]);